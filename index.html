<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUINA MUSICAL 2025</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 0; padding: 0; min-height: 100vh;
            display: flex; justify-content: center; align-items: center;
            color: white;
            background: radial-gradient(circle at top left, #1e3a8a, transparent 55%),
                        radial-gradient(circle at bottom right, #3b82f6, transparent 55%),
                        #020617;
            background-attachment: fixed;
        }
        .container {
            width: 95%; max-width: 800px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            padding: 30px; border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            text-align: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
        }
        h1 { font-weight: 900; text-transform: uppercase; letter-spacing: -1px; margin-bottom: 20px; }
        .btn {
            padding: 18px 30px; border: none; border-radius: 50px;
            font-weight: 800; cursor: pointer; transition: 0.3s;
            text-transform: uppercase; margin: 10px; display: inline-block;
        }
        .btn-primary { background: #ffffff; color: #1e3a8a; }
        .btn-spotify { background: #1DB954; color: white; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; font-size: 0.8rem; }
        input {
            padding: 15px; border-radius: 50px; border: 1px solid rgba(255,255,255,0.2);
            margin: 10px 0; width: 80%; background: rgba(255,255,255,0.1); color: white; text-align: center; font-size: 1rem;
        }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 20px; }
        .cell {
            background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px; padding: 15px 5px; font-weight: 700; font-size: 0.75rem;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            min-height: 80px; transition: 0.2s;
        }
        .cell.marked { background: #10b981; border-color: white; transform: scale(0.95); }
        .current-song-box {
            background: #ffffff; color: #1e3a8a; padding: 30px; border-radius: 20px;
            margin: 20px 0; font-size: 2rem; font-weight: 900;
        }
        .history {
            text-align: left; background: rgba(0,0,0,0.4); padding: 15px;
            border-radius: 15px; max-height: 150px; overflow-y: auto; font-size: 0.9rem;
        }
        .hidden { display: none; }
        @media (orientation: landscape) { .grid { grid-template-columns: repeat(3, 1fr); } }
    </style>
</head>
<body>

<div class="container">
    <div id="view-home">
        <h1>QUINA 2025</h1>
        <button class="btn btn-primary" onclick="showView('view-player-setup')">S√ìC JUGADOR</button>
        <button class="btn" style="background: rgba(255,255,255,0.1); color: white;" onclick="showView('view-admin')">S√ìC ORGANITZADOR</button>
    </div>

    <div id="view-player-setup" class="hidden">
        <h2>EL TEU CARTR√ì</h2>
        <input type="text" id="player-name" placeholder="EL TEU NOM">
        <input type="number" id="cartro-num" placeholder="N√öMERO DE CARTR√ì (1-200)">
        <button class="btn btn-primary" onclick="initPlayer()">ENTRAR</button>
    </div>

    <div id="view-card" class="hidden">
        <h2 id="display-info"></h2>
        <div class="grid" id="grid-cartro"></div>
        <button class="btn" style="margin-top:20px; background: #ef4444; color: white; font-size: 0.7rem;" onclick="location.reload()">SORTIR</button>
    </div>

    <div id="view-admin" class="hidden">
        <h2>CONTROL DE PARTIDA</h2>
        <div class="current-song-box" id="active-song">PREPARATS?</div>
        <div id="spotify-container" class="hidden">
            <a id="spotify-link" href="#" target="_blank" class="btn btn-spotify">BUSCAR A SPOTIFY</a>
        </div>
        <button class="btn btn-primary" style="background: #10b981; color: white;" onclick="drawSong()">üé∂ SEG√úENT CAN√á√ì (SENSE REPETIR)</button>
        <div style="margin-top:20px; text-align: left;">
            <p style="font-weight: bold; margin-bottom: 5px;">HISTORIAL (√öltimes primer):</p>
            <div id="history-list" class="history">Cap can√ß√≥ encara.</div>
        </div>
    </div>
</div>

<script>
    // Llista real de can√ßons i cartrons del teu PDF (Extracte de 200)
    const CARTRONS_BASE = [
        ["Saturday Night", "Danza Kunduro", "Hay que venir al sur", "Pedro", "Berghain", "No m'estima +", "Rehab", "Me col√© en una fiesta", "Todo de ti"],
        ["Espresso Macchiato", "Rehab", "Berghain", "No m'estima +", "Si tothom calla", "Daddy Cool", "Tandem", "Saturday Night", "Sofia"],
        ["No m'estima +", "T√†ndem", "Abracadabra", "Todo de ti", "Saturday Night", "Viva la Vida", "Shape of you", "Sweet Caroline", "Nuevayol"],
        ["Todo de ti", "The Look", "It's Not Usual", "YMCA", "Sofia", "Abracadabra", "Hay que venir al sur", "Shape of you", "No m'estima +"],
        ["Berghain", "A la freska", "Rehab", "It's Not Usual", "Hay que venir al sur", "Daddy Cool", "Espresso Macchiato", "No m'estima +", "Viva la Vida"],
        ["Abracadabra", "Shake it Off", "Saturday Night", "Nuevayol", "Viva la Vida", "Daddy Cool", "Sofia", "A la freska", "It's Not Usual"],
        ["A la freska", "Espresso Macchiato", "Daddy Cool", "Si tothom calla", "Think", "It's Not Usual", "Hay que venir al sur", "Saturday Night", "Wannabe"],
        ["Bon dia", "Viva la Vida", "Espresso Macchiato", "Berghain", "YMCA", "Everybody", "No m'estima +", "Hay que venir al sur", "Tandem"],
        ["Shake it Off", "Sta Guai", "Sweet Caroline", "Rehab", "Bon dia", "T√†ndem", "Shape of you", "Think", "Sofia"],
        ["T√†ndem", "Think", "It's Not Usual", "Todo de ti", "Sofia", "Espresso Macchiato", "Si tothom calla", "Saturday Night", "Sta Guai"],
        ["Sta Guai", "Abracadabra", "Para no verte mas", "No m'estima +", "Think", "Pedro", "Shake it Off", "YMCA", "Sweet Caroline"],
        ["Wannabe", "The Look", "Sta Guai", "T√†ndem", "Abracadabra", "YMCA", "Daddy Cool", "No m'estima +", "Me col√© en una fiesta"],
        ["YMCA", "Me col√© en una fiesta", "Think", "Wannabe", "Shape of you", "It's Not Usual", "Sta Guai", "Sweet Caroline", "Todo de ti"],
        ["Para no verte mas", "Sweet Caroline", "Danza Kunduro", "The Look", "Hay que venir al sur", "Me col√© en una fiesta", "Tandem", "Todo de ti", "Daddy Cool"],
        ["Nuevayol", "It's Not Usual", "Para no verte mas", "Todo de ti", "Me col√© en una fiesta", "T√†ndem", "Saturday Night", "A la freska", "Wannabe"],
        ["Todo de ti", "Viva la Vida", "Si tothom calla", "Daddy Cool", "Para no verte mas", "Danza Kunduro", "Saturday Night", "Everybody", "T√†ndem"],
        ["Berghain", "Daddy Cool", "Hay que venir al sur", "Viva la Vida", "Sweet Caroline", "Pedro", "The Look", "Todo de ti", "It's Not Usual"],
        ["Shape of you", "YMCA", "T√†ndem", "Para no verte mas", "It's Not Usual", "No m'estima +", "Sta Guai", "Abracadabra", "Bon dia"],
        ["Espresso Macchiato", "YMCA", "It's Not Usual", "Si tothom calla", "A la freska", "Saturday Night", "Wannabe", "Abracadabra", "The Look"],
        ["Saturday Night", "Shape of you", "No m'estima +", "Nuevayol", "Sofia", "Todo de ti", "YMCA", "Wannabe", "Bon dia"]
    ];

    // Generem els 200 cartrons per la partida basats en els patrons del PDF
    let totsElsCartrons = [];
    for(let i=0; i<200; i++) {
        totsElsCartrons.push(CARTRONS_BASE[i % 20]);
    }

    // Obtenim totes les can√ßons √öNIQUES per al bombo
    let bombo = [...new Set(totsElsCartrons.flat())];
    let sortides = [];

    function showView(viewId) {
        document.querySelectorAll('.container > div').forEach(div => div.classList.add('hidden'));
        document.getElementById(viewId).classList.remove('hidden');
    }

    function initPlayer() {
        const nom = document.getElementById('player-name').value;
        const num = parseInt(document.getElementById('cartro-num').value);
        if(!nom || isNaN(num) || num < 1 || num > 200) return alert("Escriu el teu nom i un n√∫mero entre 1 i 200");

        document.getElementById('display-info').innerText = `${nom.toUpperCase()} ‚Ä¢ CARTR√ì ${num}`;
        const grid = document.getElementById('grid-cartro');
        grid.innerHTML = '';

        totsElsCartrons[num-1].forEach(c => {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.innerText = c;
            cell.onclick = () => cell.classList.toggle('marked');
            grid.appendChild(cell);
        });
        showView('view-card');
    }

    function drawSong() {
        if (bombo.length === 0) {
            document.getElementById('active-song').innerText = "PARTIDA ACABADA";
            return alert("Ja han sortit totes les can√ßons possibles!");
        }

        // Tria aleat√≤ria
        const index = Math.floor(Math.random() * bombo.length);
        // .splice treu la can√ß√≥ del bombo perqu√® no pugui tornar a sortir
        const can√ßo = bombo.splice(index, 1)[0];
        
        sortides.unshift(can√ßo);

        // Actualitza pantalla
        document.getElementById('active-song').innerText = can√ßo;
        document.getElementById('history-list').innerHTML = sortides.map((s, i) => `<b>${sortides.length - i}.</b> ${s}`).join("<br>");
        
        // Spotify Link
        document.getElementById('spotify-container').classList.remove('hidden');
        document.getElementById('spotify-link').href = `spotify:search:${encodeURIComponent(can√ßo)}`;
    }
</script>
</body>
</html>
