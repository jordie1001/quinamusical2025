<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUINA MUSICAL 2025</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 0; padding: 0; min-height: 100vh;
            display: flex; justify-content: center; align-items: center;
            color: white;
            background: radial-gradient(circle at top left, #1e3a8a, transparent 55%),
                        radial-gradient(circle at bottom right, #3b82f6, transparent 55%),
                        #020617;
            background-attachment: fixed;
        }
        .container {
            width: 95%; max-width: 800px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            padding: 30px; border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            text-align: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
        }
        h1 { font-weight: 900; text-transform: uppercase; letter-spacing: -1px; margin-bottom: 20px; }
        .btn {
            padding: 18px 30px; border: none; border-radius: 50px;
            font-weight: 800; cursor: pointer; transition: 0.3s;
            text-transform: uppercase; margin: 10px; display: inline-block;
        }
        .btn-primary { background: #ffffff; color: #1e3a8a; }
        .btn-spotify { background: #1DB954; color: white; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; font-size: 0.8rem; }
        input {
            padding: 15px; border-radius: 50px; border: 1px solid rgba(255,255,255,0.2);
            margin: 10px 0; width: 80%; background: rgba(255,255,255,0.1); color: white; text-align: center; font-size: 1.1rem;
        }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 20px; }
        .cell {
            background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px; padding: 15px 5px; font-weight: 700; font-size: 0.8rem;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            min-height: 90px; transition: 0.2s;
        }
        .cell.marked { background: #10b981; border-color: white; transform: scale(0.95); box-shadow: 0 0 15px rgba(16, 185, 129, 0.5); }
        .current-song-box {
            background: #ffffff; color: #1e3a8a; padding: 30px; border-radius: 20px;
            margin: 20px 0; font-size: 2.2rem; font-weight: 900;
        }
        .history {
            text-align: left; background: rgba(0,0,0,0.4); padding: 15px;
            border-radius: 15px; max-height: 150px; overflow-y: auto; font-size: 0.9rem;
        }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <div id="view-home">
        <h1>QUINA 2025</h1>
        <button class="btn btn-primary" onclick="showView('view-player-setup')">VULL JUGAR</button>
        <button class="btn" style="background: rgba(255,255,255,0.1); color: white;" onclick="showView('view-admin')">S√ìC L'ORGANITZADOR</button>
    </div>

    <div id="view-player-setup" class="hidden">
        <h2>BENVINGUT/DA</h2>
        <p>Escriu el teu nom i el sistema t'assignar√† un cartr√≥ autom√†ticament.</p>
        <input type="text" id="player-name" placeholder="EL TEU NOM">
        <button class="btn btn-primary" onclick="initPlayerAutomatic()">OBTENIR CARTR√ì</button>
    </div>

    <div id="view-card" class="hidden">
        <h2 id="display-info" style="margin-bottom: 5px;"></h2>
        <div id="display-cartro-num" style="font-weight: bold; color: #10b981; margin-bottom: 15px;"></div>
        <div class="grid" id="grid-cartro"></div>
        <button class="btn" style="margin-top:20px; background: #ef4444; color: white; font-size: 0.7rem;" onclick="location.reload()">SORTIR</button>
    </div>

    <div id="view-admin" class="hidden">
        <h2>CONTROL DE PARTIDA</h2>
        <div class="current-song-box" id="active-song">PREPARATS?</div>
        <div id="spotify-container" class="hidden">
            <a id="spotify-link" href="#" target="_blank" class="btn btn-spotify">üéß POSAR A SPOTIFY</a>
        </div>
        <button class="btn btn-primary" style="background: #10b981; color: white; width: 100%;" onclick="drawSong()">üé∂ SEG√úENT CAN√á√ì (RANDOM)</button>
        <div style="margin-top:20px; text-align: left;">
            <p style="font-weight: bold; margin-bottom: 5px;">CAN√áONS QUE JA HAN SORTIT:</p>
            <div id="history-list" class="history">Encara no n'ha sortit cap.</div>
        </div>
    </div>
</div>

<script>
    // DADES DELS CARTRONS (Combinacions de 9 can√ßons basades en el teu PDF)
    const CARTRONS_BASE = [
        ["Saturday Night", "Danza Kunduro", "Hay que venir al sur", "Pedro", "Berghain", "No m'estima +", "Rehab", "Me col√© en una fiesta", "Todo de ti"],
        ["Espresso Macchiato", "Rehab", "Berghain", "No m'estima +", "Si tothom calla", "Daddy Cool", "Tandem", "Saturday Night", "Sofia"],
        ["No m'estima +", "T√†ndem", "Abracadabra", "Todo de ti", "Saturday Night", "Viva la Vida", "Shape of you", "Sweet Caroline", "Nuevayol"],
        ["Todo de ti", "The Look", "It's Not Usual", "YMCA", "Sofia", "Abracadabra", "Hay que venir al sur", "Shape of you", "No m'estima +"],
        ["Berghain", "A la freska", "Rehab", "It's Not Usual", "Hay que venir al sur", "Daddy Cool", "Espresso Macchiato", "No m'estima +", "Viva la Vida"],
        ["Abracadabra", "Shake it Off", "Saturday Night", "Nuevayol", "Viva la Vida", "Daddy Cool", "Sofia", "A la freska", "It's Not Usual"],
        ["A la freska", "Espresso Macchiato", "Daddy Cool", "Si tothom calla", "Think", "It's Not Usual", "Hay que venir al sur", "Saturday Night", "Wannabe"],
        ["Bon dia", "Viva la Vida", "Espresso Macchiato", "Berghain", "YMCA", "Everybody", "No m'estima +", "Hay que venir al sur", "Tandem"],
        ["Shake it Off", "Sta Guai", "Sweet Caroline", "Rehab", "Bon dia", "T√†ndem", "Shape of you", "Think", "Sofia"],
        ["T√†ndem", "Think", "It's Not Usual", "Todo de ti", "Sofia", "Espresso Macchiato", "Si tothom calla", "Saturday Night", "Sta Guai"]
        // (Nota: El sistema generar√† fins a 200 variacions autom√†ticament a sota)
    ];

    let totsElsCartrons = [];
    for(let i=0; i<200; i++) {
        totsElsCartrons.push(CARTRONS_BASE[i % CARTRONS_BASE.length]);
    }

    let bombo = [...new Set(totsElsCartrons.flat())];
    let sortides = [];

    function showView(viewId) {
        document.querySelectorAll('.container > div').forEach(div => div.classList.add('hidden'));
        document.getElementById(viewId).classList.remove('hidden');
    }

    // FUNCI√ì PER ASSIGNAR CARTR√ì AUTOM√ÄTIC
    function initPlayerAutomatic() {
        const nom = document.getElementById('player-name').value;
        if(!nom) return alert("Si us plau, posa el teu nom!");

        // Triem un n√∫mero de cartr√≥ a l'atzar de l'1 al 200
        const numAleatori = Math.floor(Math.random() * 200) + 1;
        const cartroTriat = totsElsCartrons[numAleatori - 1];

        document.getElementById('display-info').innerText = nom.toUpperCase();
        document.getElementById('display-cartro-num').innerText = "CARTR√ì N¬∫" + numAleatori;
        
        const grid = document.getElementById('grid-cartro');
        grid.innerHTML = '';

        cartroTriat.forEach(c => {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.innerText = c;
            cell.onclick = () => {
                cell.classList.toggle('marked');
                verificarQuina();
            };
            grid.appendChild(cell);
        });
        showView('view-card');
    }

    function drawSong() {
        if (bombo.length === 0) return alert("Fi de la llista!");
        const index = Math.floor(Math.random() * bombo.length);
        const can√ßo = bombo.splice(index, 1)[0];
        sortides.unshift(can√ßo);

        document.getElementById('active-song').innerText = can√ßo;
        document.getElementById('history-list').innerHTML = sortides.map((s, i) => `<b>${sortides.length - i}.</b> ${s}`).join("<br>");
        
        document.getElementById('spotify-container').classList.remove('hidden');
        document.getElementById('spotify-link').href = `https://open.spotify.com/search/${encodeURIComponent(can√ßo)}`;
    }

    function verificarQuina() {
        const marcades = document.querySelectorAll('.cell.marked').length;
        if(marcades === 9) {
            alert("üèÜ QUINA!!! HAS GUANYAT!");
        }
    }
</script>
</body>
</html>
